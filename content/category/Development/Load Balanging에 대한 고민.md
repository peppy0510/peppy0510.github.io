---
Title: Load Balanging에 대한 고민
Date: 2019-08-22 00:00
Tags: Development
---


네트워크 트래픽을 여러 서버로 분산하거나 가용성을 높이기 위한 로드밸런싱 방법을 고민해 보았다.

* 가끔, 한 두대의 서버 운영도 부담이 되는 소규모 개발에서 로드밸런싱이 요구되는 난감한 상황이 발생한다.
* 가장 저렴한 로드밸런싱은 어떤 것이 있는지 고민해 보았다.

#### 하드웨어 장비

* 고가의 장비를 사용해야 한다.
* 회사 재정상태가 충분하지 못하면 사용할 수 없다.

#### 클라우드 서비스에서 제공하는 로드밸런싱

* 당연하게도 클라우드 서버를 통해 서비스를 구축하였다면 이를 사용하면 된다.
* 최근에는 소규모 클라우드 서비스에서도 저렴한 요금으로 로드밸런싱을 지원하는 추세이다.

#### HAProxy

* 리눅스 서버에 설치하여 운영하는 방법이다.
* 설치와 운영방법은 인터넷에 널렸으니 이를 참고 하자.

#### DNS 서버에서의 라우팅

* 엄밀히 말하면 로드밸런싱은 아니고 말그대로 라우팅 방법이다.
* 해당 국가 혹은 대륙의 가장 가까운 곳에 위치한 서버로 라우팅하는데 많이 활용된다.

#### 클라이언트에서의 처리

* 조잡하고 번거롭지만 저렴하게 사용할 수 있는 방법이다.
* HAProxy를 위한 서버 한대도 부담이 되거나 트래픽 용량 문제로 두개 이상의 회선을 사용해야 하는 경우 고려해 볼 수 있겠다.
* 각 서버의 주소를 클라이언트 소스에 하드코딩하여 순차 혹은 램덤 접속 하는 등의 방법을 사용하면 된다.
* 요청한 서버의 주소에서 timeout 시, 에러를 핸들링하여 다음의 서버 주소로 접근하도록 하면 가용성도 어느정도 보장 할 수 있다.
* 아이피 주소가 아니라 `api01.service.com`, `api02.service.com`와 같은 서브 도메인을 사용해야 고정 아이피 할당 비용도 줄일 수 있다.
* 모바일 앱과 같이 설치파일이 배포되는 서비스의 경우, 추후 발생 할 수 있는 서버 증설 혹은 감축에 대비 하기 위해, 서버의 특정 응답에 가용한 서버의 주소 목록을 포함해서 내려주는 방법도 있을 수 있겠다.

#### 서버에서의 처리

* 조잡하고 번거롭지만 저렴하게 사용할 수 있는 방법이다.
* 마스터 서버의 트래픽이 많이 발생하는 경우, 다른 서버로 요청을 리다이렉트 하면 된다.
* 요청 횟수는 극히 적으며, 한번의 요청에 많은 연상이 필요하거나 응답량이 큰 경우에 고려해볼만 할 것 같다.
* 가용성을 높일 수 있는 방법은 아니다.
