<!DOCTYPE html><html lang=en><head><title>MUTEKLAB - Python으로 신호처리 필터 구현하기</title><meta charset=utf-8><meta content="IE=edge,chrome=1" http-equiv=X-UA-Compatible><meta charset=utf-8 content=text/html http-equiv=Content-Type><meta content="Taehong Kim" name=author><meta content=origin name=referrer><meta content=Pelican name=generator><meta content=#000000 name=theme-color><meta content=#000000 name=msapplication-navbutton-color><meta content=#000000 name=apple-mobile-web-app-status-bar-style><meta content=True name=HandheldFriendly><meta content="width=device-width, initial-scale=1.0" name=viewport><meta content=UJrW4UdiO-oEmH_o6fBNi4az0ooqxSFHNJs6RxFqa80 name=google-site-verification><link href=http://muteklab.com/pythoneuro-sinhoceori-pilteo-guhyeonhagi.html rel=canonical><meta content="신호처리의 기본이 되는 필터를 Python으로 구현해봤습니다. Matlab 예제로 많이 소개되는 필터 구현체를 참고 하였습니다. FIR Filter from scipy …" name=description><link href=/static/images/favicon.ico rel="shortcut icon"><script src=https://www.gstatic.com/firebasejs/7.6.1/firebase-app.js></script><script src=https://www.gstatic.com/firebasejs/7.6.1/firebase-firestore.js></script><script src=https://www.gstatic.com/firebasejs/7.6.1/firebase-analytics.js></script><!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-NCJZCXBKLS"></script> --><script src=/static/js/jquery.min.js type=text/javascript></script><script src=/static/js/common-menu.min.js type=text/javascript></script><script src=/static/js/md5.min.js></script><script src=/static/js/moment-with-locales.min.js type=text/javascript></script><link href=/static/css/code_blocks/github.min.css rel=stylesheet type=text/css><link href=/static/css/common.min.css rel=stylesheet type=text/css><link href=/static/css/common-menu.min.css rel=stylesheet type=text/css><link href=/static/css/common-icons.min.css rel=stylesheet type=text/css><link href=/static/css/common-alert.min.css rel=stylesheet type=text/css><link href=/static/css/common-footer.min.css rel=stylesheet type=text/css><link href=/static/css/common-pagination.min.css rel=stylesheet type=text/css><link href=/static/css/article-content.min.css rel=stylesheet type=text/css><link href=/static/css/article-loop.min.css rel=stylesheet type=text/css><link href=/static/css/article-nav.min.css rel=stylesheet type=text/css><link href=/static/css/article-comment.min.css rel=stylesheet type=text/css><script type=text/javascript>let ua=window.navigator.userAgent;if(ua.indexOf('MSIE ')>0||ua.indexOf('Trident/')>0||ua.indexOf('Edge/')>0){$('head').append('<script src="/static/js/audio-player-ie.min.js"><\/script>');$('head').append('<script src="/static/js/youtube-embed-ie.min.js"><\/script>');}else{$('head').append('<script src="/static/js/comment.min.js""><\/script>');$('head').append('<script src="/static/js/audio-player.min.js"><\/script>');$('head').append('<script src="/static/js/youtube-embed.min.js"><\/script>');}
var firebaseConfig={apiKey:"AIzaSyCKt3z0JCmxteYhxs93rsMtOqkb4_I8Em4",authDomain:"muteklab-com.firebaseapp.com",databaseURL:"https://muteklab-com.firebaseio.com",projectId:"muteklab-com",storageBucket:"muteklab-com.appspot.com",messagingSenderId:"358862433613",appId:"1:358862433613:web:6bc27b27018c4ae5",measurementId:"G-NCJZCXBKLS"};firebase.initializeApp(firebaseConfig);firebase.analytics();</script><meta content=article property=og:type><meta content="Python으로 신호처리 필터 구현하기" property=og:title><meta content="신호처리의 기본이 되는 필터를 Python으로 구현해봤습니다. Matlab 예제로 많이 소개되는 필터 구현체를 참고 하였습니다. FIR Filter from scipy …" property=og:description><meta content=http://muteklab.com/static/images/favicon.png property=og:image><meta content=http://muteklab.com/pythoneuro-sinhoceori-pilteo-guhyeonhagi.html property=og:url><meta content="Taehong Kim" property=article:author><meta content="2019-08-22 00:00:00+09:00" property=article:published_time></head><body><div class=navbar><div class=container><a href=/ class=navbar-brand><img src=/static/images/logo-muteklab.svg></a><div class=navbar-header><button class=navbar-toggle><span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button></div><div class=navbar-modal-mask></div><div class=navbar-menu><div class=dropdown><button class=dropdown-toggle> Author<b class=caret></b></button><div class=dropdown-menu><a href=/authors-information.html>Information</a><div class=divider></div><a href=/category/authors-music.html>Music</a><a href=/category/authors-mixset.html>Mixset</a><a href=/category/authors-development.html>Development</a></div></div><div class=dropdown><button class=dropdown-toggle> Articles<b class=caret></b></button><div class=dropdown-menu><a href=/category/music-articles.html>Music</a><a href=/category/development-articles.html>Development</a></div></div><div class=dropdown><button class=dropdown-toggle> Find<b class=caret></b></button><div class=dropdown-menu><a href=/archives.html>Archives</a><a href=/categories.html>Categories</a><a href=/tags.html>Tags</a></div></div></div></div></div><header class=article-header><div class=container><div class=header-title>Python으로 신호처리 필터 구현하기</div><!-- <span class="blog-description"></span> --><span class=article-meta><div class=group><a href=/category/development-articles.html> Development Articles </a><span class=seperator>|</span><time datetime=2019-08-22>2019-08-22</time></div></span></div></header><input id=article-url type=hidden value=pythoneuro-sinhoceori-pilteo-guhyeonhagi.html><main class=content><div class=container><section class=article-content><p>신호처리의 기본이 되는 필터를 Python으로 구현해봤습니다. Matlab 예제로 많이 소개되는 필터 구현체를 참고 하였습니다.</p><h6></h6><h5>FIR Filter</h5><div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>scipy</span> <span class=kn>import</span> <span class=n>signal</span>


<span class=k>def</span> <span class=nf>fir_filter</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>lowcut</span><span class=p>,</span> <span class=n>highcut</span><span class=p>,</span> <span class=n>fs</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>29</span><span class=p>):</span>
    <span class=n>nyq</span> <span class=o>=</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>fs</span>
    <span class=n>low</span> <span class=o>=</span> <span class=n>lowcut</span> <span class=o>/</span> <span class=n>nyq</span>
    <span class=n>high</span> <span class=o>=</span> <span class=n>highcut</span> <span class=o>/</span> <span class=n>nyq</span>
    <span class=k>if</span> <span class=n>low</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>data</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>coeff</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>firwin</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>highcut</span> <span class=o>/</span> <span class=n>nyq</span><span class=p>)</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>coeff</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>firwin</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>lowcut</span> <span class=o>/</span> <span class=n>nyq</span><span class=p>,</span> <span class=n>pass_zero</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>coeff</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>firwin</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=p>[</span><span class=n>low</span><span class=p>,</span> <span class=n>high</span><span class=p>],</span> <span class=n>pass_zero</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
    <span class=n>output</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>lfilter</span><span class=p>(</span><span class=n>coeff</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>output</span>
</code></pre></div><h6></h6><h5>Butterworth Filter</h5><div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>scipy</span> <span class=kn>import</span> <span class=n>signal</span>


<span class=k>def</span> <span class=nf>butter_filter</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>lowcut</span><span class=p>,</span> <span class=n>highcut</span><span class=p>,</span> <span class=n>fs</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>5</span><span class=p>):</span>
    <span class=n>nyq</span> <span class=o>=</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>fs</span>
    <span class=n>low</span> <span class=o>=</span> <span class=n>lowcut</span> <span class=o>/</span> <span class=n>nyq</span>
    <span class=n>high</span> <span class=o>=</span> <span class=n>highcut</span> <span class=o>/</span> <span class=n>nyq</span>
    <span class=k>if</span> <span class=n>low</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>data</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>butter</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>highcut</span> <span class=o>/</span> <span class=n>nyq</span><span class=p>,</span> <span class=n>btype</span><span class=o>=</span><span class=s1>'low'</span><span class=p>)</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>butter</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>lowcut</span> <span class=o>/</span> <span class=n>nyq</span><span class=p>,</span> <span class=n>btype</span><span class=o>=</span><span class=s1>'high'</span><span class=p>)</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>butter</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=p>[</span><span class=n>low</span><span class=p>,</span> <span class=n>high</span><span class=p>],</span> <span class=n>btype</span><span class=o>=</span><span class=s1>'band'</span><span class=p>)</span>
    <span class=n>output</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>filtfilt</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>output</span>
</code></pre></div><h6></h6><h5>Type I Chebyshev Filter</h5><div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>scipy</span> <span class=kn>import</span> <span class=n>signal</span>


<span class=k>def</span> <span class=nf>cheby1_filter</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>lowcut</span><span class=p>,</span> <span class=n>highcut</span><span class=p>,</span> <span class=n>fs</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>riple</span><span class=o>=</span><span class=mi>5</span><span class=p>):</span>
    <span class=n>nyq</span> <span class=o>=</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>fs</span>
    <span class=n>low</span> <span class=o>=</span> <span class=n>lowcut</span> <span class=o>/</span> <span class=n>nyq</span>
    <span class=n>high</span> <span class=o>=</span> <span class=n>highcut</span> <span class=o>/</span> <span class=n>nyq</span>
    <span class=k>if</span> <span class=n>low</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>data</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>cheby1</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>riple</span><span class=p>,</span> <span class=n>highcut</span> <span class=o>/</span> <span class=n>nyq</span><span class=p>,</span> <span class=n>btype</span><span class=o>=</span><span class=s1>'low'</span><span class=p>)</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>cheby1</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>riple</span><span class=p>,</span> <span class=n>lowcut</span> <span class=o>/</span> <span class=n>nyq</span><span class=p>,</span> <span class=n>btype</span><span class=o>=</span><span class=s1>'high'</span><span class=p>)</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>cheby1</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>riple</span><span class=p>,</span> <span class=p>[</span><span class=n>low</span><span class=p>,</span> <span class=n>high</span><span class=p>],</span> <span class=n>btype</span><span class=o>=</span><span class=s1>'band'</span><span class=p>)</span>
    <span class=n>output</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>filtfilt</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>output</span>
</code></pre></div><h6></h6><h5>Type II Chebyshev Filter</h5><div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>scipy</span> <span class=kn>import</span> <span class=n>signal</span>


<span class=k>def</span> <span class=nf>cheby2_filter</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>lowcut</span><span class=p>,</span> <span class=n>highcut</span><span class=p>,</span> <span class=n>fs</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>riple</span><span class=o>=</span><span class=mi>5</span><span class=p>):</span>
    <span class=n>nyq</span> <span class=o>=</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>fs</span>
    <span class=n>low</span> <span class=o>=</span> <span class=n>lowcut</span> <span class=o>/</span> <span class=n>nyq</span>
    <span class=n>high</span> <span class=o>=</span> <span class=n>highcut</span> <span class=o>/</span> <span class=n>nyq</span>
    <span class=k>if</span> <span class=n>low</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>data</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>cheby2</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>riple</span><span class=p>,</span> <span class=n>highcut</span> <span class=o>/</span> <span class=n>nyq</span><span class=p>,</span> <span class=n>btype</span><span class=o>=</span><span class=s1>'low'</span><span class=p>)</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>cheby2</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>riple</span><span class=p>,</span> <span class=n>lowcut</span> <span class=o>/</span> <span class=n>nyq</span><span class=p>,</span> <span class=n>btype</span><span class=o>=</span><span class=s1>'high'</span><span class=p>)</span>
    <span class=k>elif</span> <span class=n>low</span> <span class=o>!=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>high</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>cheby2</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>riple</span><span class=p>,</span> <span class=p>[</span><span class=n>low</span><span class=p>,</span> <span class=n>high</span><span class=p>],</span> <span class=n>btype</span><span class=o>=</span><span class=s1>'band'</span><span class=p>)</span>
    <span class=n>output</span> <span class=o>=</span> <span class=n>signal</span><span class=o>.</span><span class=n>filtfilt</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>output</span>
</code></pre></div></section><aside class=article-nav><a class=article-nav-left href=/python-web-minification.html><i class="ic ic-arrow-left"></i><div class=article-nav-teaser><h2 class=article-nav-title>Python Web Minification</h2><p class=article-nav-excerpt>Python으로 웹 콘텐츠를 minification 하는 방법을 소개합니다. HTML, JavaScript, CSS 등의 소스 파일에서 불필요한 공백...</p></div></a><div class=article-nav-seperator></div><a class=article-nav-right href=/sublimetext-majcumbeob-geomsagi-hwalyonghagi.html><div class=article-nav-teaser><h2 class=article-nav-title>SublimeText 맞춤법 검사기 활용하기</h2><p class=article-nav-excerpt>SublimeText에서 맞춤법 검사기 활용 방법을 소개합니다. 참고로 SublimeText는 hunspell을 사용하여 맞춤법 검사를 지원합니다. 사용자...</p></div><i class="ic ic-arrow-right"></i></a><div class=clear></div></aside><div class=article-comment><div class=comment-title><div class=comment-count></div></div><div class=comment-input><div class=comment-body><textarea id=comment-content placeholder="Comment (at least 3 chars)" type=text></textarea></div><div class=comment-foot><input id=comment-username placeholder="Name (optional)" type=text><input id=comment-email placeholder="Email (optional)" type=text><button id=comment-submit-button onclick=onClickSubmitCommentButton()>Submit</button></div></div><div class=comment-list></div></div> </div></main><footer class=footer><div class=container><div class=credits><div class=group-container><div class=group><a class=avatar href=/authors-information.html><img class=avatar src="https://avatars1.githubusercontent.com/u/21299773?s=460&v=4"></a></div><div class=group><a href=/category/authors-music.html> Author's Music </a><a href=/category/authors-mixset.html> Author's Mixset </a><a href=/category/authors-development.html> Author's Development </a></div></div><div class=group-container><div class=group><a href=/category/music-articles.html> Music Articles </a><a href=/category/development-articles.html> Development Articles </a></div><div class=group><a href=/archives.html> Find in Archives </a><a href=/categories.html> Find in Categories </a><a href=/tags.html> Find in Tags </a></div><div class=group><a href=https://github.com/peppy0510 target=_blank>GitHub</a></div></div></div></div></footer></body></html>